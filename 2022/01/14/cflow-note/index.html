<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/blogs/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/blogs/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="This is the note of cflow design from UIUC.">
<meta property="og:type" content="article">
<meta property="og:title" content="Note of Cflow">
<meta property="og:url" content="https://fanweneddie.github.io/blogs/2022/01/14/cflow-note/index.html">
<meta property="og:site_name" content="Wen Fan&#39;s blog">
<meta property="og:description" content="This is the note of cflow design from UIUC.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://blogs.uni-paderborn.de/sse/files/2013/05/aliasFlow-e1454777310898-300x133.png">
<meta property="og:image" content="https://fanweneddie.github.io/blogs/pictures/cflow/list1.png">
<meta property="article:published_time" content="2022-01-14T09:22:48.000Z">
<meta property="article:modified_time" content="2022-01-15T09:18:57.518Z">
<meta property="article:author" content="Wen Fan">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blogs.uni-paderborn.de/sse/files/2013/05/aliasFlow-e1454777310898-300x133.png"><title>Note of Cflow | Wen Fan's blog</title><link ref="canonical" href="https://fanweneddie.github.io/blogs/2022/01/14/cflow-note/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/blogs/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/blogs/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: undefined,
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"simple","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/blogs/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/blogs/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/blogs/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Note of Cflow</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-01-14</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-01-15</span></span></div></header><div class="post-body"><p>This is the note of the paper of <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/xlab-uiuc/cflow/blob/master/doc/cflow_report.pdf" >“cFlow:Flow-based Configuration Analysis Framework for Java Bytecode Based Cloud System”</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> from UIUC Xlab.</p>

        <h1 id="abstract"   >
          <a href="#abstract" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#abstract"></a> Abstract</h1>
      
<ol>
<li>
<p>modern software systems are customizable via configuration, and misconfiguration may cause system failure.</p>
</li>
<li>
<p>Existing attempt of static taint analysis is deeply coupled with upstream analyses and does not support taint propagation path recovery.</p>
</li>
<li>
<p>The author builds a static taint analysis framework to output the taint propagation paths for upstream configuration analyses.</p>
</li>
</ol>

        <h1 id="background"   >
          <a href="#background" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#background"></a> Background</h1>
      
<p><strong>taint propagation:</strong><br />
Follow untrusted data and identify points where they are misused.</p>
<p>According to <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.blackhat.com/presentations/bh-dc-08/Chess-West/Presentation/bh-dc-08-chess-west.pdf" >here</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>,</p>
<p><strong>Sources:</strong> instrument methods that introduce input to set taint markers</p>
<p><strong>Sinks:</strong> instrument sensitive methods to check for taint marker before executing</p>
<p><strong>domain specific analysis:</strong><br />
The domain means a type of software application?</p>
<p><strong>FlowDroid:</strong><br />
According to <a href="(https://blogs.uni-paderborn.de/sse/tools/flowdroid/)">here</a>, FlowDroid is a context-, flow-, field-, object-sensitive and lifecycle-aware static taint analysis tool for Android applications.</p>
<p>When we are trying to analyze the connection between source to the link, we need to analyze forward and backward.</p>
<img src="http://blogs.uni-paderborn.de/sse/files/2013/05/aliasFlow-e1454777310898-300x133.png" >
<div align = "center">Figure 1: Taint analysis</div>
<p>for example, in the figure above,(3) is the reverse analysis.</p>
<p><strong>non-deterministic taint flow</strong></p>
<p>When we run <code>cflow</code> on the same application for two times, we may get different results. After my check, this is caused by</p>
<ul>
<li><strong>Non-deterministic execution sequence of taint propagation:</strong> In set-based dataflow analysis, we use <code>hashSet</code> in implementation. Since the iteration over <code>hashSet</code> does not guarantee any sequence, the taint analysis does not have a deterministic sequence.</li>
<li></li>
</ul>

        <h1 id="approach"   >
          <a href="#approach" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#approach"></a> Approach</h1>
      

        <h2 id="overview-what-cflow-does"   >
          <a href="#overview-what-cflow-does" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#overview-what-cflow-does"></a> Overview: What Cflow does</h2>
      
<ul>
<li>
<p><strong>Preprocess:</strong> leveraging <code>Soot</code>, we transform java bytecode into Jimple IR &amp; call graph</p>
</li>
<li>
<p><strong>sink manager:</strong> to identify the configuration of loading points and sink points</p>
</li>
<li>
<p><strong>taint propagation engine:</strong></p>
<ul>
<li>
<p>each tainted object is represented with a taint abstraction.</p>
</li>
<li>
<p>when there is an assignment <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>←</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">s \leftarrow t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>, we can create a new taint abstraction for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>, and draw a directed edge from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>.</p>
</li>
<li>
<p>Therefore, the output of the taint propogation phase is a directed taint propogation graph</p>
</li>
</ul>
</li>
</ul>

        <h2 id="field-sensitive-taint-abstraction"   >
          <a href="#field-sensitive-taint-abstraction" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#field-sensitive-taint-abstraction"></a> Field sensitive taint abstraction</h2>
      
<ul>
<li>How to model field access?
<ul>
<li><strong>field based approach:</strong> treat fields as entities independent of base objects(overtainting)</li>
<li><strong>field sensitive approach:</strong> dependent of the base objects</li>
</ul>
</li>
<li>we adopt <code>field sensitive approach</code>. we trade off precision for scalability and simplicity in implementation and limits the field access path length to 1. (which means there is no nested fields such as <code>b.f1.f2</code>)</li>
</ul>

        <h2 id="taint-policy"   >
          <a href="#taint-policy" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#taint-policy"></a> taint policy</h2>
      
<ul>
<li><strong>Taint sources:</strong> After loading configuration into program variables, those variables are served as initial taints for the analysis and all the other variables are initialized as untainted.</li>
<li><strong>Taint Sinks:</strong> CFlow allows users to specify how to identify sink statements.</li>
<li><strong>Taint propagation:</strong>
<ul>
<li>forward dataflow analysis in <strong>interprocedual control flow graph(ICFG)</strong></li>
<li>we only track explicit information flow(ignore implicit flow)</li>
</ul>
</li>
</ul>

        <h3 id="pointwise-flow-functions"   >
          <a href="#pointwise-flow-functions" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#pointwise-flow-functions"></a> pointwise flow functions</h3>
      

        <h4 id="assignment"   >
          <a href="#assignment" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#assignment"></a> Assignment:</h4>
      
<ul>
<li><strong>receive</strong> the incoming taints from the previous statement of the assignment</li>
<li><strong>pass</strong> the taints to the next statement of the assignment</li>
<li>for the form <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo>=</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo>∣</mo><mi>U</mi><mi>n</mi><mi>O</mi><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo stretchy="false">)</mo><mo>∣</mo><mi>B</mi><mi>i</mi><mi>n</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo separator="true">,</mo><mi>z</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo stretchy="false">)</mo><mo>∣</mo><mi>C</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo stretchy="false">)</mo><mo>∣</mo><mi>I</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mi>o</mi><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x.* = y.* \mid UnOp(y.*) \mid Binop(y.*, z.*) \mid Cast(y.*) \mid Instanceof(y.*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord">.</span><span class="mord">∗</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>
<ul>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, then the new taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">T&#x27; = \empty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span>. (That’s because the tainted object of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span> is flushed by untainted object of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">y.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">z.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>)</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>y</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo>∣</mo><mi>z</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = y.* \mid z.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">.</span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, then the new taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>T</mi><mo>∪</mo><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T&#x27; = T \cup x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>.</li>
<li>else, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">T&#x27; = T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>.(just pass them on)</li>
</ul>
</li>
</ul>

        <h4 id="call-flow-function"   >
          <a href="#call-flow-function" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#call-flow-function"></a> Call Flow Function:</h4>
      
<ul>
<li>
<p><strong>receive</strong> the incoming taints from the previous statement in the caller.</p>
</li>
<li>
<p><strong>pass</strong> the taints to the entry node of the caller.</p>
</li>
<li>
<p>for the call form <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi mathvariant="normal">.</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o.m(a_0,a_1,...,a_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>:</p>
<ul>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = a_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span> in caller, then in callee entry, the taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T&#x27; = p_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">p_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span> is the variable that stores the i-th parameter of the method <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>.</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>o</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = o.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, then in callee entry, the taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T&#x27; = this.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">this</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span></span></span></span> is this object in the callee</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">T = S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> is a static field, then the taint set in callee entry <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">T&#x27; = S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>.</li>
<li>else, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">T&#x27; = \empty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span>.</li>
</ul>
</li>
</ul>

        <h4 id="return-flow-function"   >
          <a href="#return-flow-function" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#return-flow-function"></a> Return Flow Function:</h4>
      
<ul>
<li>
<p><strong>receive</strong> the incoming taint from the exit node of callee</p>
</li>
<li>
<p><strong>pass</strong> the taints to the next statement of the caller</p>
</li>
<li>
<p>for the call form <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi mathvariant="normal">.</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o.m(a_0,a_1,...,a_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<ul>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = p_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span> in callee, then the next taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T&#x27; = a_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">p_i.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">∗</span></span></span></span> is the variable that stores the i-th parameter of the method <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>.</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = this.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, then the next taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>o</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T&#x27; = o.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">this</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span></span></span></span> is this object in the callee</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">T = S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> is a static field, then the next taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">T&#x27; = S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>.</li>
<li>else, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">T&#x27; = \empty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span>.</li>
</ul>
</li>
<li>
<p>for the call form <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mi>o</mi><mi mathvariant="normal">.</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = o.m(a_0,a_1,...,a_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<ul>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span> in callee, then the next taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">T&#x27; = \empty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span>.</li>
<li>if incoming taint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mi>r</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">T = r.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">.</span><span class="mord">∗</span></span></span></span> in callee where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">r.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">.</span><span class="mord">∗</span></span></span></span> is the return object in the callee, then the next taint set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">T&#x27; = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>(in the document, it is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span>, maybe that’s because field length is assumed as 1)</li>
</ul>
</li>
</ul>

        <h2 id="scalable-interprocedural-analysis"   >
          <a href="#scalable-interprocedural-analysis" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#scalable-interprocedural-analysis"></a> Scalable Interprocedural Analysis</h2>
      
<p><strong>HOPE:</strong> We want to scale cflow to large software systems.</p>

        <h3 id="summary-based-analysis"   >
          <a href="#summary-based-analysis" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#summary-based-analysis"></a> Summary-based Analysis</h3>
      
<ul>
<li>
<p>Since many methods are called multiple times, we want to cache the separate analysis results for different calling contexts(passed taint abstractions)</p>
</li>
<li>
<p>Each of the results of different taint abstrations should be analyzed.</p>
</li>
</ul>

        <h3 id="library-modeling"   >
          <a href="#library-modeling" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#library-modeling"></a> Library Modeling</h3>
      
<p><strong>Problem:</strong> How to analyze library calls</p>
<p>It is not feasible to precisely directly analyze the libraries.</p>
<ul>
<li>
<p><code>FlowDroid</code>: models common library calls using a few heuristic-based rules</p>
</li>
<li>
<p>We also provide some rules to handle common strings,collection and math operations and a few common third-party libraries in Hadoop.</p>
</li>
</ul>

        <h3 id="call-graph-consideration"   >
          <a href="#call-graph-consideration" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#call-graph-consideration"></a> Call graph consideration</h3>
      
<p><strong>Problem:</strong> how to handle dynamic polymorphism and reflection in Java?</p>
<ul>
<li>Cflow uses <code>call graph</code>, but it will not build an accurate call graph due to the consideration of running time and memory consumption. <strong>So cflow does not consider polymorphism or reflection by default.</strong></li>
</ul>

        <h2 id="path-reconstruction"   >
          <a href="#path-reconstruction" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#path-reconstruction"></a> Path Reconstruction</h2>
      
<p><strong>Problem:</strong> How to generate a directed taint propagation path from source to sink?</p>
<ul>
<li>
<p>Cflow traverse the taint propagation graph and reconstruct the propagation graph.</p>
</li>
<li>
<p>Use stack(or DFS) to solve.</p>
</li>
<li>
<p>For cycles introduced by loops, <strong>we keep track of all visited taint abstractions for each active method invocation(so we can unroll each loop only once)</strong></p>
</li>
<li>
<p>For recursive calls, we keep track of the whole calling stack and stops traversing when a recursive call is detected.</p>
</li>
</ul>

        <h1 id="evaluation"   >
          <a href="#evaluation" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#evaluation"></a> Evaluation</h1>
      
<p>To test whether cFlow can</p>
<ul>
<li>track taint inter- and intra-procedurally?</li>
<li>support field-sensitivity?</li>
<li>overall performance on real world application</li>
</ul>

        <h2 id="rq1-intra-and-inter-procedural-taint-tracking"   >
          <a href="#rq1-intra-and-inter-procedural-taint-tracking" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#rq1-intra-and-inter-procedural-taint-tracking"></a> RQ1: Intra- and inter-procedural taint tracking</h2>
      
<p>Here is the example in Figure 2.<br />
<img src="/blogs/pictures/cflow/list1.png" alt="list1" /></p>
<div align = "center">Figure 2: An example</div>
<p>In this example, variable <code>duration</code> in method <code>getShutdownTimeOut</code> is the source of taint.</p>
<p>Then, the taint is propagated to variabel <code>shutdownTimeout</code> in method <code>shutdownExecutor</code></p>
<p>The taint tracking terminates prior to <code>LOG.error</code> or <code>awaitTermination</code> because these functions are external to <code>Hadoop</code>.</p>

        <h2 id="rq2-field-sensitivity-in-cflow"   >
          <a href="#rq2-field-sensitivity-in-cflow" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#rq2-field-sensitivity-in-cflow"></a> RQ2. Field-sensitivity in CFlow</h2>
      
<p>The example is still in Figure 2.</p>
<p>However, cFlow still has some limitations:</p>
<ul>
<li>does not support implicit information flow</li>
<li>does not support tracking static and nested field access</li>
<li>take loops and recursion too easily</li>
<li>hard to make a fine-grain heuristic rules</li>
<li>aliasing, dynamic polymorphism and reflection</li>
</ul>

        <h2 id="infrastructure-of-cflow"   >
          <a href="#infrastructure-of-cflow" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#infrastructure-of-cflow"></a> infrastructure of Cflow</h2>
      
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java bytecode</span><br><span class="line"> |</span><br><span class="line"> | (Soot)</span><br><span class="line"> | </span><br><span class="line">Jimple IR &amp; call graph</span><br><span class="line"> |</span><br><span class="line">taint analysis &amp; taint propogation</span><br><span class="line"> |</span><br><span class="line">directed taint propogation graph of taint abstractions             </span><br></pre></td></tr></table></div></figure>

        <h2 id="field-sensitive"   >
          <a href="#field-sensitive" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#field-sensitive"></a> field-sensitive</h2>
      
<p>field-based:</p>
<ul>
<li>treat fields as <strong>independent</strong> of the base objects they belong to.</li>
<li>may cause over-tainting()</li>
</ul>
<p>field-sensitive:</p>
<ul>
<li>treat fields as <strong>dependent</strong> of their base objects</li>
<li>limit the field access length to 1 for simplicity</li>
</ul>

        <h2 id="taint-policy-2"   >
          <a href="#taint-policy-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#taint-policy-2"></a> taint policy</h2>
      
<p>taint sources:</p>
<ul>
<li>program variables at configuration loading site: initial taints</li>
<li>other variables: untainted</li>
</ul>

        <h2 id="taint-sink"   >
          <a href="#taint-sink" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#taint-sink"></a> taint sink</h2>
      
<p>Any taint abstractions that flows into a sink statement will be reported later with the corresponding propagation path.</p>

        <h2 id="taint-propagation"   >
          <a href="#taint-propagation" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#taint-propagation"></a> taint propagation</h2>
      
<p>The author only tracks explicit information flow resulted from sequence of <strong>assignments</strong></p>

        <h2 id="call-graph-function"   >
          <a href="#call-graph-function" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#call-graph-function"></a> call graph function</h2>
      
<p>get the taint from the caller and send those to callee. For example,</p>
<ul>
<li>in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi mathvariant="normal">.</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o.m(a_0,a_1,...,a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>i</mi><mo>→</mo><mi>p</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">ai \rightarrow pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">i</span></span></span></span></li>
<li>in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo>=</mo><mi>o</mi><mi mathvariant="normal">.</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x.* = o.m(a_0,a_1,...,a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, set the return value as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>, then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mo>→</mo><mi>x</mi><mi mathvariant="normal">.</mi><mo>∗</mo></mrow><annotation encoding="application/x-tex">r.* \rightarrow x.*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">.</span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span><span class="mord">∗</span></span></span></span></li>
</ul>

        <h2 id="scalable-interprocedural-analysis-2"   >
          <a href="#scalable-interprocedural-analysis-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#scalable-interprocedural-analysis-2"></a> scalable interprocedural analysis</h2>
      
<p><strong>summary-based analysis</strong><br />
To maintain context-sensitivity of the analysis, separate analysis results for different calling contexts(taint abstractions) are cached.</p>
<p>It suffice to compute a summary of the method for each possible incoming taint abstractions and union them.</p>
<p><strong>Source-Independent taint abstraction</strong></p>
<p>If we store the source information in a taint abstraction, we can easily know whether there is a taint propogation path between each pair of sources and links</p>
<p>Else, taint abstractions are independent of any information irrevelant to the actual taint abstraction.</p>
<p><strong>Library modeling</strong></p>
<p>It is not feasible to directly analyze the libraries.</p>
<p>The authors provide a set of predefined rules that handle the common string</p>
<p><strong>call graph consideration</strong></p>
<p>To handle dynamic polymorphism and reflection in JAVA, we need an accurate call graph<br />
But cflow can use SPARK to generate a simple call graph.</p>
<p><strong>path reconstruction</strong></p>
<p>The main challenge for cFlow to reconstructs the propogation path is to maintain context-sensitivity during the traversal to avoid reconstructing unrealizable taint propogation paths</p>
<p>We can keep track of the call sites in a stack when traversing the taint propagation graph, to make it maintain context-sensitive property</p>
<p>for loops, we keep track of all visited taint abstractions for each active method invocation so we can unroll each loop only once</p>
<p>for recursive calls, we keep track of the whole calling stack and stops traversing when a recursive call is detected</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://fanweneddie.github.io/blogs">Wen Fan</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://fanweneddie.github.io/blogs/2022/01/14/cflow-note/">https://fanweneddie.github.io/blogs/2022/01/14/cflow-note/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/blogs/2022/01/14/cflow-source-code-analysis/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">Cflow Source Code Analysis</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/blogs/2022/01/14/flowdroid-source-code-analysis/"><span class="paginator-prev__text">FlowDroid Source Code Analysis</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#abstract"><span class="toc-number">1.</span> <span class="toc-text">
           Abstract</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#background"><span class="toc-number">2.</span> <span class="toc-text">
           Background</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#approach"><span class="toc-number">3.</span> <span class="toc-text">
           Approach</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#overview-what-cflow-does"><span class="toc-number">3.1.</span> <span class="toc-text">
           Overview: What Cflow does</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#field-sensitive-taint-abstraction"><span class="toc-number">3.2.</span> <span class="toc-text">
           Field sensitive taint abstraction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#taint-policy"><span class="toc-number">3.3.</span> <span class="toc-text">
           taint policy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pointwise-flow-functions"><span class="toc-number">3.3.1.</span> <span class="toc-text">
           pointwise flow functions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#assignment"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">
           Assignment:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#call-flow-function"><span class="toc-number">3.3.1.2.</span> <span class="toc-text">
           Call Flow Function:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#return-flow-function"><span class="toc-number">3.3.1.3.</span> <span class="toc-text">
           Return Flow Function:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scalable-interprocedural-analysis"><span class="toc-number">3.4.</span> <span class="toc-text">
           Scalable Interprocedural Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#summary-based-analysis"><span class="toc-number">3.4.1.</span> <span class="toc-text">
           Summary-based Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#library-modeling"><span class="toc-number">3.4.2.</span> <span class="toc-text">
           Library Modeling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call-graph-consideration"><span class="toc-number">3.4.3.</span> <span class="toc-text">
           Call graph consideration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-reconstruction"><span class="toc-number">3.5.</span> <span class="toc-text">
           Path Reconstruction</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#evaluation"><span class="toc-number">4.</span> <span class="toc-text">
           Evaluation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rq1-intra-and-inter-procedural-taint-tracking"><span class="toc-number">4.1.</span> <span class="toc-text">
           RQ1: Intra- and inter-procedural taint tracking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rq2-field-sensitivity-in-cflow"><span class="toc-number">4.2.</span> <span class="toc-text">
           RQ2. Field-sensitivity in CFlow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#infrastructure-of-cflow"><span class="toc-number">4.3.</span> <span class="toc-text">
           infrastructure of Cflow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#field-sensitive"><span class="toc-number">4.4.</span> <span class="toc-text">
           field-sensitive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#taint-policy-2"><span class="toc-number">4.5.</span> <span class="toc-text">
           taint policy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#taint-sink"><span class="toc-number">4.6.</span> <span class="toc-text">
           taint sink</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#taint-propagation"><span class="toc-number">4.7.</span> <span class="toc-text">
           taint propagation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#call-graph-function"><span class="toc-number">4.8.</span> <span class="toc-text">
           call graph function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scalable-interprocedural-analysis-2"><span class="toc-number">4.9.</span> <span class="toc-text">
           scalable interprocedural analysis</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://fanweneddie.github.io/img/profile.png" alt="avatar"></div><p class="sidebar-ov-author__text">Wen Fan</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://fanweneddie.github.io" target="_blank" rel="noopener" data-popover="Homepage" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fas fa-home"></i></span></a><a class="sidebar-ov-social-item" href="https://fanweneddie.github.io/personal/WenFan_CV.pdf" target="_blank" rel="noopener" data-popover="CV" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">CV</span></a><a class="sidebar-ov-social-item" href="https://github.com/fanweneddie" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="mailto:eddie@mail.ustc.edu.cn" target="_blank" rel="noopener" data-popover="Email" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fas fa-envelope"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/blogs/archives/"><div class="sidebar-ov-state-item__count">29</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/blogs/categories/"><div class="sidebar-ov-state-item__count">3</div><div class="sidebar-ov-state-item__name">Categories</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/blogs/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Wen Fan</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.0.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="/blogs/js/utils.js?v=2.6.2"></script><script src="/blogs/js/stun-boot.js?v=2.6.2"></script><script src="/blogs/js/scroll.js?v=2.6.2"></script><script src="/blogs/js/header.js?v=2.6.2"></script><script src="/blogs/js/sidebar.js?v=2.6.2"></script></body></html>